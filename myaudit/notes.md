## Attack Idea
- Dos
- Calculations: fee calculations
- Double spend
- skip limitations : skip the fee
- access control for storage accounts. is the owner a legitimate program?
- Cross-program invocation (CPI) vulnerabilities
- input validation

**math + precision + logic + input validation**

sometime protocol works wrongly
sometime you exploit a correct working protocol

## to do:
- finish first iteration (done)
- distinguish main flows and actors (done)
- run tests with boundry and edge cases for those flows
- test order: Protocol Administration → Configuration Management → Access Controls → Pool Lifecycle → Fee Distribution → Trading Mechanics → Migration Processes


- ckeck all events for QA reports


- read frankcastleaudirot reports

- interact with current onchain programs using solana.fm for better understanding
- read past audits (there are 3)
- read DBC docs. done
- search common solana vulns



## past audits 
[link](https://github.com/MeteoraAg/audits/)

## current UI
[dlmm create](https://app.meteora.ag/dlmm/create)
[pools](https://app.meteora.ag/)

## current related programs
```
DAMM v2 Program	cpamdpZCGKUy5JxQXB4dcpGPiikHawvSWAd6mEn1sGG
DAMM v1 Program	Eo7WjKq67rjJQSZxS6z3YkapzY3eMj6Xy8X5EQVn5UaB
DBC Program	dbcij3LWUppWqq96dh6gJWwBifmcGfLSB5D4DuSMaqN
```
### An example config
[config](https://solana.fm/address/FbKf76ucsQssF7XZBuzScdJfugtsSKwZFYztKsMEhWZM/transactions?cluster=mainnet-alpha)

## Excalidraw link
[excalidraw](https://excalidraw.com/#json=lb04eQ-lFPjNx2ossWq7b,w3V2bfNQ9VV3y0tJDP3ODQ)

## code2Tut
[link](https://code2tutorial.com/tutorial/fe10879a-a9e3-45eb-a85e-4ca8e449b1fb/01_bonding_curve_mechanics_.md)
## TEST

Use `anchor test tests/yourtest.tests.ts` instead of 'pnpm test'
add `rust_log=error' or 'info' or 'debug'` or 'warning' to change the debugging logs

```
test = "RUST_LOG=ERROR yarn run ts-mocha -p ./tsconfig.json -t 1000000 --reporter spec tests/**/*.ts"

```


## Diagrams

### SWap
- swap class diagram
[link](https://mermaid.live/view#pako:eNrNVl1v2jAU_SuRn2CjUUMDhahCqqgmTVq1aq32MCFZbmKC1cROHYdBK_77rp0PHEi2Po4n8DnXuffcc294R6GIKApQmJA8v2MkliRdcQc-5sR5ECJZCr5msfNenjvO5wwO8ZrSPDD4F_hWchpGKJKEhkqTcApPCJxi1oApg6coJjh-LYSiWG0kzTciiYA19TtozyTvZSUifKER3tJcMR7jsJ1HniVM4YxIxanEhEc4lJQoIXVmA7hn6DyU4C2PliX0qGOgpvNy3ZgqrIQi5ifmRUqluezTwHXdYU-ApkIRJBUFVxbxsOK20j-ZVAVJtKCW1GU9oHPx_EL3zbFRJGVcdSNbUiTnUKl2N2bCQGAqt7QtcBnVCWVSKAGtLhsEdfbA5RXneNWWnugK7Qmu-9gdXKM9wfmrBFdIFupzb3y0JgkV25amy4SRt9uRUFoMkuQtXzPOFCMJe6NtO5AsS_Y4_00yLSOo34aLLCKQZCap4XSDIlcdKMtxWEBbwPZpllBVWfoZPNRwtAWbTugJUJJEelRq5QbDY5EnnoQpuIfptfyoXY2bkRQvlAftx21IDlWuqZQkCc4zqRfC4HRDjBydF8URk3AMGo8c-6phnUtnno-gzA8jrZUq9BLmCTOeFaqavnY7RaH6IE53oHefS2oF-x1_htR1nCNaFcbDpIhgjWk1ynzgbFBtDlNBf5OOxY-t6ltX9mtAdx-iVTkldP3famjP19ASpVezpdp1LNrbMNSlfBNgRnlzfP0tWtv9lGct70XnKn7So1LFdC_kToa15-_ZWWQHULbQDCYm5WU9V1ed-wg1I3sqA-eRxbCQjx00kSZDsw5JWoV_5YrKNQnpCbVM-l_cpssnmX3P9Fa4sRNctAxwsj_ABE_65K4-ODGC9c_mxnXb68V-F19cLCxuidf2ERq0yB3oX0PP1baHWTNsH6MRiiWLUKBkQUcI_nykRP9ExsUrpDY0pSsUwNeIrrWrVmjFDxCWEf5LiLSOlKKINyhYkySHX-Urpvrv11AoB18vdWIomM3MFSh4RzsUXE9cf345v5p5k_l07M-nI7RHwZXvXo8n3nzueVfexJv5k8MIvZmHeu5s5kPA9HLmz31v4vuHPx3IauE)

- swap Seq Diagram
[link](https://mermaid.live/view#pako:eNqVVV1P2zwU_iuer4KWhX4BaaRy0QDTq3cTQUAvpkqRl5y21hw72E7HhvjvO076kZZoYtwQ2895zjnP-egLzVQONKIGniqQGVxxttSsmEuCf6yySlbFd9DNuWTa8oyXTFrySJghjwb0aSw4SPsWETtE80jur_4_fQDTgUoc6moak0Qr55l4KyZzAan5ycr0p2ZlCfqkg_3ms7NMlBKxkgu-JB7LMlVJ2wFObm-_OPSMa1sx4Yz-Bp_OHHjKDJAZq4Ql3n3yhTyoHyA70Hc1-q5S9l3wh2Tq8PXzPmnnrBN81wGufXWgr2cPDn29RsnNXDaAx0-Xl3FEphUXOblHUROGJGBBm8ELK5wEac8nm6--T2rhC2yL14YgRoIkIh1l8TL77LsIWGE24bDM8jVDJZLmnDjvN58jIhTLvZP9pStJc5sWlT14icgSbGo1yyHNuQakVPIIodFHKnjBMY-Am7R9TjE4bDt0RzBmsmaC5-7ZcLncZsClsbrqZMZJQKfehxK7xFFnlV5DmqmiFKiaV3AsgrNLn1wZUrvSYFZK5CeHPFVZOy114_HIywKg1phMyA3AV_yKIpf19t7LlBCY-e7CJzspfKwFZgwL0JqJrfDYd7vKkcmEXD9jLf7bNEHLc6lVBsY0MoADoRjb6EBgz7-lua3se3jUvpBviRLXqEzccCH-zlU2wHSByB2dzA_kq4Gou5u2SfuUDgInY-vmSHjXG78O3ptCYd1xma3BnKLi5tQ8aYu14xm0zHF0I4J9KQ1Kny60KtIKjbwgCAiXmahyyOuCcVlWNm1G6oS0Ce6OCVyX1QQoXsuosVGlPaj1oXAd4ezYthZESfJ9v1veE0jb9Km1aVo1QAbcNREBnDdcN9atFX_7Mdg35D-P0GGU05kbx_bmaBUyW0H2o84tXbutGzTKkcsJ2fPXzzt68tHNncF_WGeL2-ANqcHe2VuXbuFiXzpZDgI4zj92-cWb9I7UyqG9E6lPl5rnNMLtAz4tQBfMHemLQ8-pXUEBcxrhZw4Ll9eczuUrmuGG_6ZUsbXUqlquaLRgOGg-bXp48-O9g2AMoGOnCo0GZ6Oag0Yv9JlGn4bn42A4HPXC_igcX_TPBj79RaMwGI16vcE47PeHo3E4Dl99-rv2OgiG5xfh-Tg8Cy_Ci2EvPH_9AwrJuk0)

- tokens in solana
[link](https://mermaid.live/view#pako:eNrdWOlu20YQfpUFiyA2IrkSKVES0QSQrzaNr1hyXaQqjCW5lBYhuSx3aVs5gP7qA_QR-mh5ks5yeSwlW7F7pED1R-Lu7Dcz38zODPXe8JhPDMeYpzhZoOnuLEbwefIE7ZOAxgRxsQwJRwFLkU-DgKQkFgh7HsvgWywTwtUJL8Scwxkk2FsSn6UMACMU0DB0vgoC27XdFhcp7Dlf-bbVsbrFY_uG-mLhWMlty2MhS6V0sAIZ0ViMC5UKcdBzR0FQIXZGwx6xmojmJsTcyCZkv48tDdL0rZ5lPwISC1wgdTrucNSrjevgzrD_GKRMLFhKxbKkz_dcm1R4pDvo9NfxVkAyTtJLHIak9A-bIzeoUWyv75HBZquqXJhKulAZ1K3Tm5ikiIGlYaiobKckxIL4ZWbwbXV2evbTzGicLtbl0lsyfx2QN0t6cjP-3j1xv311dvjj3mW2ex2MJtw2rR9e9_fH6sDzzR8llNvloN2zwyOGfZKq1YNb4mUCuyFxkEgzolb3IV7OimMvY6Aj8wRlcZHVRzhKWCq4g84h79vklkSJQC4OceyRmfGz4zh6vmuUHUPOojLDJjlslha6j8fAii6gli9i-ktG0Nj3U8I5SoDj3L7HM3AH4zoLAQ65RgM6pCT0uaNWPv36R37hrqo0dNBpIjn55ixz35Lli1qOZ0kSwn5m9-pFn3g0Ag2wPKxXKb-iMRUUh_Qd8R3kMhbWu0FKyDvyOZUPiIZWKtby955oTMfdKklLkW7BDknpNWQ1FL9zHPssKoPz34TEQYoOtPXpt98bGbZdCzKlT5e8gFqAVDHQBHEkT64FLyRzuMkbYi7y7ULxRD41ohxjAZxV5wH9xTq8f3Wndi9k_J_IAr28l2kwHZtrYTYLxqvG9oXC66AJjmRvLRIRYS7TUAm4mdBa7TUOM8L_ludwAcacM4_mFbrJwNYkgeuKw7yVy5Le2C6yZTyVBes-DCVztj-uKteWTwRJIWMpF9Tb_kJsSg7X7Spt8ourHKQs0q6VdjWawZebjRq-tgus1J1j_8ERAoO1wGj6C-iLS1mOdLuKvDjwzX6_O5I3O6QeekWWjyd2suSCRI9g9gDshyoyOT2CbGUpnkOSxOFye9VdKdBws54_Sm8vLs0Vx8z_h2PyfhUli5ZX9fjlyfRqfDH9rur0ZVFT-3s4Ri7kbLwsKvUjXN5jMUxtIVejF_JSgmWVrIFlr0AxuVECvKExJdew6KMtDgEQDJ2wmGwXmVmbqI4cnh8cvDko3TjMe_S_6Eg-BNB4XgOrseBrscCFL9V8-Zd9gmCdy1lVzngLmnDUVikkH8qZFbV32i8-QCPlH2BWu2u1Ktary-Zdy1ApNqhfIbTKHNQGAK8Mp2C1LVpcKiFFlWbZZiHz80KbrT4neYPyyoQHvTlCbmwgpxeUMPjNG5aD4gdIycq6WaqpMx951gWhkja13itnNvVuwquvPAjn86F2-UBCxV11G45uqFjUfh2P1a48ilU7WaX5CLskVK_bqc54M61mRtl4ZIKpvepdrL4jxrrqmXEKL_U5sTLWC3xdVMUoCwVNQnIHRpVSNcgYlOXMyOvGZfeVkEq4ILMmyvep9AOGDN0lKBkxE1h72eKZq_6FAPyi6eazcCP1ZoYSlh-fpiR_W0NH5_UqoJL1if6pNPBpEdTV8bmMBtSMJs76yPg0Tw4dSO9o9-FYcn6qo46ey3lpSz_5TBn0TB8rtiscEvtlkugsVX8UrFCEHsJRb601IRo3aZHuVUVaEiir86pv_Tt6w2akqtCvQtkAtcvEovoLBPppnqdakXeXCMq8tKQs9U2WjJYxT6lvOPJdv2VEMIhi-Wi8l0IzQyxIBEcc-OmTAEPay5T6CMcSHL9hLCpPpiybLwwnnxxaRpb4MPruUywDU4mARpLuSQ8Npzvo5RiG8964NRxzsNPrjga93sga9Ecj02oZS1i1duzB0LS6NqzY5nDwsWW8y5V2d6zhqDvqWh272-v1TLv_8U8Y1V7W)

- swap, configs, activation_handler relations
[link](https://mermaid.live/view#pako:eNqFU21v2jAQ_iuWpWpfIAqUl2BNlbLwMiRGEWTtNDKlXnKApcSObIe2g_73OQFGWjr1U3J3zz333JPLDkciBkzwKhGP0YZKjSbzgCOk8t9rSbMN8m6nw_Eo_Hbb_z4ZLAOD5yu2tqQK8K8CiJA3HC1nQiTeoUIjzbZUM8FD_ZwBqudnXDgcDBYleAigDg019IUqMPEp7D9zmrKokrEsq-QAHgf8lTrX88d3rj--nYZf3Wl_MpgbiRUFG8rjBGRVrusv3X8Av1AIPE-PxdFsuQYdRrmUwHWYCcY1qqOLnW5Q3mn9R9Pi3p2d_ZJPoXqkWVXB4j70_B_LhUl7-unzJ8ZX4sbMiETOtTqD7ufubGY2OixR0oSPZkQG8gi6cyfjvusPlluasJhqA2J8fcIyrrTMo0L2a6lXV2gOSbmP2rBMFTnzdVC9frOXQGO1r4yvFjMptiwG9daQvTGuwI1mRw6dS67QKxvfcp6jsidXhraQjTIqaQoa5EGGseodeESTxNRPBryDgJRphWBrBFSIjut7UihVT0WcJ4BYmgmp1VsOy5A8GFkoksZZQkpdipBCJCG-pDH0mYTS34d94dFHDJeHScjFuRmqy6v-iFnp8nH-DQtB1T834LiG15LFmJibgBpOQaa0CPGuIA-w3kAKASbmNYYVzRMd4IC_mLaM8p9CpKdOKfL1BpMVTZSJ8qy4uz6j5vjPEHNqIL3injFp2u2SA5MdfsKkZXXbttO2r9stp9frNk3xGZNGo2v1HKdjm3zDttut7ksN_ymnNiy72Wo6Had53TGQptN--QvkYJIe)